
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../qa_tools/">
      
      
        <link rel="next" href="../ci/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.6">
    
    
      
        <title>Integration Testing - Jobbergate Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.35e1ed30.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#integration-testing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Jobbergate Documentation" class="md-header__button md-logo" aria-label="Jobbergate Documentation" data-md-component="logo">
      
  <img src="https://omnivector-public-assets.s3.us-west-2.amazonaws.com/branding/omnivector-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Jobbergate Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Integration Testing
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/omnivector-solutions/jobbergate" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    omnivector-solutions/jobbergate
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Jobbergate Documentation" class="md-nav__button md-logo" aria-label="Jobbergate Documentation" data-md-component="logo">
      
  <img src="https://omnivector-public-assets.s3.us-west-2.amazonaws.com/branding/omnivector-logo.png" alt="logo">

    </a>
    Jobbergate Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/omnivector-solutions/jobbergate" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    omnivector-solutions/jobbergate
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Elements
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Elements
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Resources
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../elements/resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../elements/resources/job_scripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Job Scripts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../elements/resources/job_script_templates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Job Script Templates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../elements/resources/job_submissions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Job Submissions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Apps
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Apps
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../elements/apps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../elements/apps/agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jobbergate Agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../elements/apps/api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jobbergate API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../elements/apps/cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jobbergate CLI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../elements/apps/core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jobbergate Core
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../authors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authors
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developer Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Developer Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../dev_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developer Tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../qa_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quality Assurance Tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Integration Testing
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Integration Testing
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    Setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging-in-through-the-cli" class="md-nav__link">
    Logging in through the CLI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-an-application" class="md-nav__link">
    Creating an Application
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#querying-a-single-application" class="md-nav__link">
    Querying a single Application
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-an-application" class="md-nav__link">
    Updating an Application
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rendering-a-job-script-from-an-application" class="md-nav__link">
    Rendering a Job Script from an Application
  </a>
  
    <nav class="md-nav" aria-label="Rendering a Job Script from an Application">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-interactive-render" class="md-nav__link">
    Basic, interactive render
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#render-in-fast-mode-with-a-param-file" class="md-nav__link">
    Render in "fast mode" with a --param-file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#render-with-additional-sbatch-params" class="md-nav__link">
    Render with additional SBATCH params
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-a-job-script" class="md-nav__link">
    Updating a Job Script
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submitting-a-job-script" class="md-nav__link">
    Submitting a Job Script
  </a>
  
    <nav class="md-nav" aria-label="Submitting a Job Script">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#submit-the-job-through-the-cli" class="md-nav__link">
    Submit the job through the CLI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-that-the-agent-submitted-the-job" class="md-nav__link">
    Verify that the agent submitted the job
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-that-the-job-was-completed" class="md-nav__link">
    Verify that the job was completed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-the-output-from-the-job" class="md-nav__link">
    Verify the output from the job
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ci/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Continuous Integration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../keycloak_setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Keycloak Setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../template_workflows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Template Workflows
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jobbergate Agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jobbergate API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jobbergate CLI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jobbergate Core
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    Setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging-in-through-the-cli" class="md-nav__link">
    Logging in through the CLI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-an-application" class="md-nav__link">
    Creating an Application
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#querying-a-single-application" class="md-nav__link">
    Querying a single Application
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-an-application" class="md-nav__link">
    Updating an Application
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rendering-a-job-script-from-an-application" class="md-nav__link">
    Rendering a Job Script from an Application
  </a>
  
    <nav class="md-nav" aria-label="Rendering a Job Script from an Application">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-interactive-render" class="md-nav__link">
    Basic, interactive render
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#render-in-fast-mode-with-a-param-file" class="md-nav__link">
    Render in "fast mode" with a --param-file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#render-with-additional-sbatch-params" class="md-nav__link">
    Render with additional SBATCH params
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-a-job-script" class="md-nav__link">
    Updating a Job Script
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submitting-a-job-script" class="md-nav__link">
    Submitting a Job Script
  </a>
  
    <nav class="md-nav" aria-label="Submitting a Job Script">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#submit-the-job-through-the-cli" class="md-nav__link">
    Submit the job through the CLI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-that-the-agent-submitted-the-job" class="md-nav__link">
    Verify that the agent submitted the job
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-that-the-job-was-completed" class="md-nav__link">
    Verify that the job was completed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-the-output-from-the-job" class="md-nav__link">
    Verify the output from the job
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="integration-testing">Integration Testing</h1>
<p>While conducting integration testing for Jobbergate, it's critical to examine the entire
cycle of the platform, ranging from the creation of an Application to remote
Job Submission via the Jobbergate Agent.</p>
<p>To test most of the platforms functionality, the <code>docker-compose</code> setup located in the
<a href="https://github.com/omnivector-solutions/jobbergate/jobbergate-composed">Jobbergate Composed</a>
sub-project is sufficient. Begin by referring to the guide in that sub-project's README.
Pay close attention to the execution of Jobbergate CLI commands as they play a
significant role in integration testing. For testing you can use the pre-configured user
credentials:</p>
<ul>
<li><strong>Username:</strong> local-user</li>
<li><strong>Password:</strong> local</li>
</ul>
<p>Integration testing should cover the following work-flows:</p>
<ul>
<li>Logging in through the CLI</li>
<li>Creating an Application</li>
<li>Querying a single Application</li>
<li>Updating an Application</li>
<li>Rendering a Job Script from an Application</li>
<li>Updating a Job Script</li>
<li>Submitting a Job Script</li>
<li>Verifying a Job Submission</li>
<li>Deleting the Job Submission, Job Script, and Application</li>
<li>Logging out through the CLI</li>
</ul>
<h2 id="setup">Setup</h2>
<p>To begin, you will need two separate terminals open. Change directory to the
<code>jobbergate-composed</code> sub-project of the top-level <code>jobbergate</code> folder.</p>
<p>First, you need to start up the Jobbergate platform with docker-compose. In one of your
terminals, run the following command:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>docker-compose<span class="w"> </span>up<span class="w"> </span>--build
</span></code></pre></div>
<p>Once all the services are started, jump into the prepared <code>jobbergate-cli</code> container
to execute CLI commands. To do so, execute this command in the other terminal you have
prepared:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>docker-compose<span class="w"> </span>run<span class="w"> </span>jobbergate-cli<span class="w"> </span>bash
</span></code></pre></div>
<p>Now you may start executing commands with the Jobbergate CLI.</p>
<p>To assist with some of the commands below, create a <code>NAME</code> environment variable that
will help to identify resources that you create during the process. You should
set the value based on the current date so that the associated resources are easy to
identify. Run the following command to set it:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">NAME</span><span class="o">=</span><span class="s2">&quot;test--</span><span class="k">$(</span>whoami<span class="k">)</span><span class="s2">--</span><span class="k">$(</span>date<span class="w"> </span>-I<span class="k">)</span><span class="s2">&quot;</span>
</span></code></pre></div>
<p>You have now created a test name like <code>test--tbeck--2023-10-13</code>.</p>
<h2 id="logging-in-through-the-cli">Logging in through the CLI</h2>
<p>The first work-flow you will test covers the auth mechanics of both the CLI and the API.</p>
<p>Run the following command in the Jobbergate CLI:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>jobbergate<span class="w"> </span>login
</span></code></pre></div>
<p>Next, open the link that is printed out and log in as <code>local-user</code> (password "local").
If asked, grant all of the permissions.</p>
<p>Verify that the CLI reports that the user has been successfully logged in.</p>
<p>At this point, verify that the token that has been retrieved for the user is correct.</p>
<p>Run the following command in the CLI:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>jobbergate<span class="w"> </span>show-token<span class="w"> </span>--decode
</span></code></pre></div>
<p>This command will pretty print the payload of the token.
Verify that it contains:</p>
<ul>
<li>"view" and "edit" <code>permissions</code> for job-templates, job-scripts, and job-submissions</li>
<li><code>email</code> equalling "<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#108;&#111;&#99;&#97;&#108;&#45;&#117;&#115;&#101;&#114;&#64;&#106;&#111;&#98;&#98;&#101;&#114;&#97;&#116;&#101;&#46;&#108;&#111;&#99;&#97;&#108;">&#108;&#111;&#99;&#97;&#108;&#45;&#117;&#115;&#101;&#114;&#64;&#106;&#111;&#98;&#98;&#101;&#114;&#97;&#116;&#101;&#46;&#108;&#111;&#99;&#97;&#108;</a>"</li>
<li><code>aud</code> includes "<a href="https://local.omnivector.solutions">https://local.omnivector.solutions</a>"</li>
<li><code>azp</code> equals "jobbergate-cli"</li>
</ul>
<h2 id="creating-an-application">Creating an Application</h2>
<p>Next, test the command to create an Application through the CLI, and verify that the
resource is created in the database. Also, verify that the files are successfully
uploaded to the file store.</p>
<p>For integration testing, use the built-in
<a href="https://github.com/omnivector-solutions/jobbergate/tree/main/examples/simple-application">simple application</a>.
example. This example application has 3 simple template variables, and, when submitted,
the rendered Job Script simply prints the values of those variables.</p>
<p>Run the following command in the Jobbergate CLI:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>jobbergate<span class="w"> </span>applications<span class="w"> </span>create<span class="w"> </span>--name<span class="o">=</span><span class="nv">$NAME</span><span class="w"> </span>--identifier<span class="o">=</span><span class="nv">$NAME</span><span class="w"> </span>--application-path<span class="o">=</span>/example
</span></code></pre></div>
<p>Verify that output shows that a single application was inserted and that the files were
uploaded:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>                    Created Application
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>┏━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>┃ Key                  ┃ Value                            ┃
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>┡━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>│ id                   │ 1                                │
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>│ name                 │ test--root--2023-10-13           │
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>│ owner_email          │ local-user@jobbergate.local-mail │
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>│ is_archived          │ False                            │
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>│ description          │                                  │
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>│ identifier           │ test--root--2023-10-13           │
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>│ application_uploaded │ True                             │
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>└──────────────────────┴──────────────────────────────────┘
</span></code></pre></div>
<h2 id="querying-a-single-application">Querying a single Application</h2>
<p>Next, verify that we can look up a single Application by both its <code>id</code> and its
<code>identifier</code>. Also include the <code>--full</code> argument to the base <code>jobbergate</code> command
so that the output will show all the fields in the database including the source file,
the config, and the timestamps.</p>
<p>First, fetch the Application by <code>id</code> using the following command in the CLI:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>jobbergate<span class="w"> </span>--full<span class="w"> </span>applications<span class="w"> </span>get-one<span class="w"> </span>--id<span class="o">=</span><span class="m">1</span>
</span></code></pre></div>
<p>The output should look something like this:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>┏━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>┃ Key            ┃ Value                                                                                                                                 ┃
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>┡━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>│ id             │ 1                                                                                                                                     │
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>│ name           │ test--root--2023-10-13                                                                                                                │
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>│ owner_email    │ local-user@jobbergate.local-mail                                                                                                      │
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>│ created_at     │ 2023-10-13T19:44:21.935886                                                                                                            │
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>│ updated_at     │ 2023-10-13T19:44:21.958325                                                                                                            │
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>│ identifier     │ test--root--2023-10-13                                                                                                                │
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>│ description    │                                                                                                                                       │
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>│ template_vars  │ {&#39;bar&#39;: &#39;BAR&#39;, &#39;baz&#39;: &#39;BAZ&#39;, &#39;foo&#39;: &#39;FOO&#39;, &#39;workdir&#39;: &#39;/nfs&#39;}                                                                         │
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>│ template_files │ [{&#39;parent_id&#39;: 5, &#39;filename&#39;: &#39;dummy-script.py.j2&#39;, &#39;file_type&#39;: &#39;ENTRYPOINT&#39;, &#39;created_at&#39;: &#39;2023-10-13T19:44:22.020542&#39;,            │
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>│                │ &#39;updated_at&#39;: &#39;2023-10-13T19:44:22.020556&#39;}]                                                                                          │
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>│ workflow_files │ [{&#39;parent_id&#39;: 5, &#39;filename&#39;: &#39;jobbergate.py&#39;, &#39;runtime_config&#39;: {&#39;template_files&#39;: None, &#39;job_script_name&#39;: None,                    │
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>│                │ &#39;default_template&#39;: &#39;dummy-script.py.j2&#39;, &#39;output_directory&#39;: &#39;.&#39;, &#39;supporting_files&#39;: None, &#39;supporting_files_output_name&#39;: None},   │
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>│                │ &#39;created_at&#39;: &#39;2023-10-13T19:44:22.110739&#39;, &#39;updated_at&#39;: &#39;2023-10-13T19:44:22.110750&#39;}]                                              │
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>└────────────────┴───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
</span></code></pre></div>
<p>Verify that the <code>id</code>, <code>name</code>, <code>identifier</code>, and timestamps match the Application
that was created.</p>
<p>Next, fetch the same application by <code>identifier</code> and verify that it is the same
Application:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>jobbergate<span class="w"> </span>--full<span class="w"> </span>applications<span class="w"> </span>get-one<span class="w"> </span>--identifier<span class="o">=</span>test--tbeck--2023-10-13
</span></code></pre></div>
<h2 id="updating-an-application">Updating an Application</h2>
<p>Next, verify that you can update the application through the CLI.</p>
<p>Run this command to verify that we can change the name:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>jobbergate<span class="w"> </span>applications<span class="w"> </span>update<span class="w"> </span>--id<span class="o">=</span><span class="m">1</span><span class="w"> </span>--application-desc<span class="o">=</span><span class="s2">&quot;Here is a test description&quot;</span>
</span></code></pre></div>
<p>Verify that you can see the new description in the application when you fetch it via the
<code>get-one</code> subcommand. Also, check the output with the <code>--full</code> parameter to make
sure that the <code>updated_at</code> field is different and later than the <code>created_at</code> field.</p>
<h2 id="rendering-a-job-script-from-an-application">Rendering a Job Script from an Application</h2>
<p>Now that an application has been uploaded uploaded, use it to render a new Job Script.</p>
<p>There are a few different options to test here to check for correct behavior:</p>
<ul>
<li>Basic, interactive render</li>
<li>Render in "fast mode" with a <code>--param-file</code></li>
<li>Render with additional SBATCH params</li>
</ul>
<h3 id="basic-interactive-render">Basic, interactive render</h3>
<p>First, render an Application to a Job Script by executing the interactive code that
gathers the values for template variables from the user.</p>
<p>To start the rendering process, execute:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>jobbergate<span class="w"> </span>job-scripts<span class="w"> </span>render<span class="w"> </span>--name<span class="o">=</span><span class="nv">$NAME</span><span class="w"> </span>--application-id<span class="o">=</span><span class="m">1</span>
</span></code></pre></div>
<p>Verify that you are shown 3 prompts to supply values for the template variables. Fill
these in with any values you like. Notice that the third question has a default response
supplied already. Accept this value or replace it with your preferred value:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>   [?] gimme the foo!: FOO
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>   [?] gimme the bar!: BAR
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>   [?] gimme the foo!: BAZ
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>   [?] gimme the workdir!: /nfs
</span></code></pre></div>
<p>When prompted if you would like to submit the job, decline with "n".</p>
<p>After completing the questions, verify that the CLI reports that the new Job Script was
created using the supplied values:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>                 Created Job Script
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>┏━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>┃ Key            ┃ Value                            ┃
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>┡━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>│ id             │ 1                                │
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>│ application_id │ 1                                │
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>│ name           │ test--root--2023-10-13           │
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>│ description    │                                  │
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>│ owner_email    │ local-user@jobbergate.local-mail │
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>└────────────────┴──────────────────────────────────┘
</span></code></pre></div>
<p>Now we need to verify that the Job Script was rendered with the correct values. Run the
following command:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>jobbergate<span class="w"> </span>job-scripts<span class="w"> </span>show-files<span class="w"> </span>--id<span class="o">=</span><span class="m">1</span>
</span></code></pre></div>
<p>The output should show the Job Script with the provided template variable values
rendered as expected:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>╭─────────────────────────────────────────────────────────────────── dummy-script.py ────────────────────────────────────────────────────────────────────╮
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>│                                                                                                                                                        │
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>│   #!/bin/python3                                                                                                                                       │
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>│                                                                                                                                                        │
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>│   #SBATCH -J dummy_job                                                                                                                                 │
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>│   #SBATCH -t 60                                                                                                                                        │
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>│                                                                                                                                                        │
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>│   print(&quot;Executing dummy job script&quot;)                                                                                                                  │
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>│   with open(&quot;/nfs/dummy-output.txt&quot;, mode=&quot;w&quot;) as dump_file:                                                                                           │
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>│       print(&quot;I am a very, very dumb job script&quot;, file=dump_file)                                                                                       │
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>│       print(&quot;foo=FOO&quot;, file=dump_file)                                                                                                                 │
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a>│       print(&quot;bar=BAR&quot;, file=dump_file)                                                                                                                 │
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a>│       print(&quot;baz=BAZ&quot;, file=dump_file)                                                                                                                 │
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a>│                                                                                                                                                        │
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a>╰─────────────────────────────────────────────────────────── This is the main job script file ───────────────────────────────────────────────────────────╯
</span></code></pre></div>
<h3 id="render-in-fast-mode-with-a-param-file">Render in "fast mode" with a <code>--param-file</code></h3>
<p>Next, verify that a Job Script can be rendered while skipping the interactive question
answering segment by pre-supplying the application with the values to use for rendering.
Since only the third question has a default, supply at least the other two questions
with a param using the <code>--param-file</code> parameter.</p>
<p>First, create a file to hold the params (hit <code>ctrl-d</code> to finish and write the file):</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>cat<span class="w"> </span>&gt;<span class="w"> </span>params.json
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="o">{</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">  </span><span class="s2">&quot;foo&quot;</span>:<span class="w"> </span><span class="s2">&quot;FOO&quot;</span>,
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">  </span><span class="s2">&quot;bar&quot;</span>:<span class="w"> </span><span class="s2">&quot;BAR&quot;</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="o">}</span>
</span></code></pre></div>
<p>Now, render the Application using this file. Include the <code>--no-submit</code> flag because
the Job Script shouldn't be submitted immediately. Verify only the rendering process for
the new Job Script:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>jobbergate<span class="w"> </span>job-scripts<span class="w"> </span>render<span class="w"> </span>--name<span class="o">=</span><span class="nv">$NAME</span><span class="w"> </span>--application-id<span class="o">=</span><span class="m">1</span><span class="w"> </span>--fast<span class="w"> </span>--param-file<span class="o">=</span>params.json<span class="w"> </span>--no-submit
</span></code></pre></div>
<p>The output from the command will show you the default values that were used that you did
not specify in the <code>params.json</code> file:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>Default values used
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>┏━━━━━━━━━┳━━━━━━━┓
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>┃ Key     ┃ Value ┃
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>┡━━━━━━━━━╇━━━━━━━┩
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>│ baz     │ zab   │
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>│ workdir │ /nfs  │
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>└─────────┴───────┘
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>                 Created Job Script
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>┏━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a>┃ Key            ┃ Value                            ┃
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a>┡━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a>│ id             │ 2                                │
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a>│ application_id │ 1                                │
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a>│ name           │ test--root--2023-10-13           │
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a>│ description    │                                  │
</span><span id="__span-18-18"><a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a>│ owner_email    │ local-user@jobbergate.local-mail │
</span><span id="__span-18-19"><a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a>└────────────────┴──────────────────────────────────┘
</span></code></pre></div>
<p>Now check the rendered file again using the <code>show-files</code> sub-command.</p>
<h3 id="render-with-additional-sbatch-params">Render with additional SBATCH params</h3>
<p>Finally, test that additional <code>SBATCH</code> params can be inserted at render time. The code
will insert these additional parameters into the rendered Job Script files.</p>
<p>To supply extra <code>SBATCH</code> params, they are provided on the command line using the
<code>--sbatch-params</code> option. Use this command to test it out:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>jobbergate<span class="w"> </span>job-scripts<span class="w"> </span>render<span class="w"> </span>--name<span class="o">=</span><span class="nv">$NAME</span><span class="w"> </span>--application-id<span class="o">=</span><span class="m">1</span><span class="w"> </span>--fast<span class="w"> </span>--param-file<span class="o">=</span>params.json<span class="w"> </span>--no-submit<span class="w"> </span>--sbatch-params<span class="o">=</span><span class="s2">&quot;--cluster=fake&quot;</span><span class="w"> </span>--sbatch-params<span class="o">=</span><span class="s2">&quot;--partition=dummy&quot;</span>
</span></code></pre></div>
<p>The output should look like:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>Default values used
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>┏━━━━━━━━━┳━━━━━━━┓
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>┃ Key     ┃ Value ┃
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>┡━━━━━━━━━╇━━━━━━━┩
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>│ baz     │ zab   │
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>│ workdir │ /nfs  │
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>└─────────┴───────┘
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>                 Created Job Script
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>┏━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>┃ Key            ┃ Value                            ┃
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a>┡━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>│ id             │ 3                                │
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>│ application_id │ 1                                │
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a>│ name           │ test--root--2023-10-13           │
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a>│ description    │                                  │
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a>│ owner_email    │ local-user@jobbergate.local-mail │
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a>└────────────────┴──────────────────────────────────┘
</span></code></pre></div>
<p>Now, review the rendered Job Script file using the <code>--show-files</code> command. You should
see that the additional two SBATCH parameters are included:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1">#SBATCH --cluster=fake                                                                                                                               │</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="c1">#SBATCH --partition=dummy</span>
</span></code></pre></div>
<h2 id="updating-a-job-script">Updating a Job Script</h2>
<p>Next, verify that an existing Job Script can be updated.</p>
<p>Run this command to verify that you can change the description:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>jobbergate<span class="w"> </span>job-scripts<span class="w"> </span>update<span class="w"> </span>--id<span class="o">=</span><span class="m">1</span><span class="w"> </span>--description<span class="o">=</span><span class="s2">&quot;Here is a test description&quot;</span>
</span></code></pre></div>
<p>Verify that you can see the new description in the Job Script when you fetch it via the
<code>get-one</code> subcommand. Also, check the output with the <code>--full</code> parameter to make
sure that the <code>updated_at</code> field is different and later than the <code>created_at</code> field.</p>
<h2 id="submitting-a-job-script">Submitting a Job Script</h2>
<p>Next, test the process of submitting a Job Script to a slurm cluster for execution.
Note that the <code>docker-compose.yaml</code> used for testing sets up a volume-mounted
directory named <code>/nfs</code>. The <code>/nfs</code> directory in the container is mounted from the
<code>slurm-fake-nfs</code> directory in the <code>jobbergate-composed</code> subproject. You can look in this
directory after the job completes execution to check the results.</p>
<p>You will need to verify that jobs are being submitted correctly vai the following steps:</p>
<ul>
<li>Submit the job through the CLI</li>
<li>Verify that the agent submitted the job</li>
<li>Verify that the agent updates the Job Submission status</li>
<li>Verify the output from the job</li>
</ul>
<h3 id="submit-the-job-through-the-cli">Submit the job through the CLI</h3>
<p>Submit the Job Script using the CLI by running the following command:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>jobbergate<span class="w"> </span>job-submissions<span class="w"> </span>create<span class="w"> </span>--name<span class="o">=</span><span class="nv">$NAME</span><span class="w"> </span>--job-script-id<span class="o">=</span><span class="m">1</span><span class="w"> </span>--cluster-name<span class="o">=</span>local-slurm<span class="w"> </span>--execution-directory<span class="o">=</span>/nfs
</span></code></pre></div>
<p>Verify that the output shows that the Job Submission has been created for the target
Job Script</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>                  Created Job Submission
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>┃ Key                 ┃ Value                            ┃
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>│ id                  │ 1                                │
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>│ job_script_id       │ 1                                │
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>│ cluster_name        │ local-slurm                      │
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>│ slurm_job_id        │ None                             │
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>│ execution_directory │ /nfs                             │
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>│ name                │ test--root--2023-10-13           │
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a>│ description         │                                  │
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a>│ owner_email         │ local-user@jobbergate.local-mail │
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>│ status              │ CREATED                          │
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>│ report_message      │ None                             │
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a>└─────────────────────┴──────────────────────────────────┘
</span></code></pre></div>
<h3 id="verify-that-the-agent-submitted-the-job">Verify that the agent submitted the job</h3>
<p>To verify that the agent submitted the job correctly, review the log output from the
agent.</p>
<p>The agent performs the following process to complete a Job Submission with Slurm</p>
<ul>
<li>Fetch a pending job from the API</li>
<li>Submit the job to slurm</li>
<li>Mark the job as submitted and add the slurm job id to it</li>
</ul>
<p>You can access the log data by running the following command in a terminal that has
changed directory to the <code>jobbergate-composed</code> folder:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>docker-compose<span class="w"> </span>logs<span class="w"> </span>jobbergate-agent
</span></code></pre></div>
<p>It may be useful to pipe the output to a text viewer like <code>less</code>.</p>
<p>If the agent has successfully submitted the job, you should see some log lines that
look like this (ellipses indicate omitted content):</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>...Retrieved 1 pending job submission...
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>...Submitting pending job submission 1
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>...
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>...Submitting pending job submission 1 to slurm...
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>...
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>...Received slurm job id 1 for job submission 1
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>...Marking job job_submission_id=22 as SUBMITTED (slurm_job_id=1)
</span></code></pre></div>
<p>If you find those log lines, then the Agent has successfully submitted the job to slurm.</p>
<h3 id="verify-that-the-job-was-completed">Verify that the job was completed</h3>
<p>To verify that the job completed successfully, review the log output from the
agent.</p>
<p>The agent performs the following process to complete Job Submissions</p>
<ul>
<li>Fetch the submitted job from the API</li>
<li>Check the status of the job in slurm using the the <code>slurm_job_id</code></li>
<li>If the job is completed, mark the Job Submission as COMPLETED</li>
</ul>
<p>You should look for log lines that look like this (ellipses indicate omitted content):</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>...Retrieved 1 active job submissions...
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>...Fetching status of job_submission 1 from slurm
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>...Fetching slurm job status for slurm job 1
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>...
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>...Status for slurm job 1 is job_id=1 job_state=&#39;COMPLETED&#39;...
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>...Updating job_submission with status=COMPLETED
</span></code></pre></div>
<h3 id="verify-the-output-from-the-job">Verify the output from the job</h3>
<p>In the terminal where you are running Jobbergate CLI commands, you can check the <code>/nfs</code>
directory to see the results. You should see three output files in the directory:</p>
<ul>
<li>test--root--2023-10-13.out</li>
<li>test--root--2023-10-13.err</li>
<li>dummy-output.txt</li>
</ul>
<p>First, check the standard output from the script:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>cat<span class="w"> </span>/nfs/test--root--2023-10-13.out
</span></code></pre></div>
<p>You should see a single line that says:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>Executing dummy job script
</span></code></pre></div>
<p>The standard error from the script should be empty.</p>
<p>The final file, <code>dummy-output.txt</code>, should contain the following content:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>I am a very, very dumb job script
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>foo=FOO
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>bar=BAR
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>baz=BAZ
</span></code></pre></div>
<h2 id="conclusion">Conclusion</h2>
<p>The process described in this document covers integration tests across the entire
Jobbergate platform. These integration tests should be performed before new versions of
Jobbergate are published and before Jobbergate is deployed to a new environment.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../qa_tools/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Quality Assurance Tools">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Quality Assurance Tools
              </div>
            </div>
          </a>
        
        
          
          <a href="../ci/" class="md-footer__link md-footer__link--next" aria-label="Next: Continuous Integration">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Continuous Integration
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.expand", "navigation.footer", "navigation.tracking", "content.code.copy"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
    
  </body>
</html>